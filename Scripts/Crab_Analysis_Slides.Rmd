---
title: "Human Impact on Ghost Crab Burrows"
output: ioslides_presentation
---


## Concept
- Ghost crab population size declines under high human impact
  - Respond strongly to impacts so good indicator of effective beach management
- Human impact on burrow dimensions is still being debated
  - Data was collected to determine this impact
```{r, echo=FALSE, out.width="45%"}
knitr::include_graphics("../Images/Slide Images/South_Carolina_Beaches.jpg")
```



## Project Goals 
1. Load data from [Ghost Crab Burrow Morphology and Distribution](https://doi.org/10.6084/m9.figshare.6895109) 
2. Analyze human impact on ghost crab burrow dimensions and architecture
3. Present findings/data in a way that is clean and understandable



## Required Packages
- Tidyverse
- Magrittr
- Knitr
```{r load-packages, echo=FALSE, cache=TRUE}
library(magrittr)
library(knitr)
library(tidyverse)
```



## Importing Data
[Ghost Crab Burrow Morphology and Distribution](https://doi.org/10.6084/m9.figshare.6895109) data was collected in South Carolina between May and Sept. of 2016.
```{r,echo=FALSE, fig.align='center', cache=TRUE}
burrow_raw_data <- read.csv("../Data/Ghost_crab_burrow_architecture.csv")
dimensions_tibble <- as_tibble(burrow_raw_data[, 1:5])
dimensions_table <- head(dimensions_tibble)
knitr::kable(dimensions_table, 
             col.names = c('Site', 'Impact Types', 'Burrow Shape', 'Beach Slope', 'Sand Compaction'))
```



## Filtering and Selecting Data
Burrow opening diameter and impact types
```{r,echo=FALSE, fig.align='center', cache=TRUE}
diameter_impact <- burrow_raw_data %>%
  arrange(desc(average.burrow.diameter)) %>%
  select(site, average.burrow.diameter, impact.types)
diameter_impact_tibble <- as_tibble(diameter_impact)
diameter_impact_table <- head(diameter_impact_tibble)
knitr::kable(diameter_impact_table, 
             col.names = c('Site', 'Opening Diameter (mm)', 'Impacts'))
```

## Plotting Data
```{r,echo=FALSE, fig.align='center', cache=TRUE}
#Selecting data
diameter_average <- diameter_impact %>% 
  group_by(impact.types) %>%
  summarise(avg = median(average.burrow.diameter)) 
Diam_avg <- data.frame(diameter_average) %>%
  arrange(desc(impact.types))
#Plotting data
diam_avg_plot <- ggplot(Diam_avg, 
                        aes(x = reorder(impact.types, -avg), 
                            y = avg, fill = impact.types)) +
  geom_bar(stat = "identity", alpha = 0.4) +
  theme_bw() + 
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_blank(), 
        axis.line = element_line()) +
  ggtitle("Opening Diameter (mm) vs Human Impact") +
  theme(plot.title = element_text(hjust = 0.9)) +
  labs(y="Average Diameter (mm)", 
       x = "Human Impact") +
  geom_errorbar(aes(ymin = avg, ymax = avg), 
                color = "#22292F", width = .3) +
  scale_y_continuous(expand = c(0, 0))

plot(diam_avg_plot)
```



## Filtering and Selecting Data
Burrow density and impact types
```{r}
density_impact <- burrow_raw_data %>%
  select(site, average.burrow.diameter, impact.types)
density_impact_tibble <- as_tibble(density_impact)
density_impact_table <- head(density_impact_tibble)
knitr::kable(density_impact_table, 
             col.names = c('Site', 'Opening Diameter (mm)', 'Impact Type'))
```



# Filtering and Selecting Data
Burrow length and impact type
```{r}
length_impact <- burrow_raw_data %>%
  select(site, burrow.length, impact.types)
length_impact_tibble <- as_tibble(length_impact)
length_impact_table <- head(length_impact_tibble)
knitr::kable(length_impact_table, 
             col.names = c('Site', 'Length (mm)', 'Impact Type'))
```
























## Part III (a)
Plotting burrow **sites** vs **depth** vs **temperature** vs **month**.
```{r, echo=FALSE, fig.align='center'}
burrow_data_plot <- ggplot(burrow_site_depth_temp_month, aes(x = burrow.depth, y = burrow.temperature,
                                                             color = month)) +
  geom_point() +
  facet_wrap(~site) +
  geom_smooth(method = "loess") +
  labs(x = "Burrow Depth (mm)", y = "Burrow Temperature (°C)") +
  labs(title = "Burrow Depth vs Temperature") +
  theme(plot.title = element_text(hjust = 0.5))
print(burrow_data_plot)
```


## Part III (b)
Plotting burrow **sites** vs **shape** vs **temperature**.
```{r, echo=FALSE, fig.align='center'}
burrow_data_plot_2 <- ggplot(burrow_shape_temperature_sites, aes(x = burrow.shape, y = burrow.temperature, color = burrow.shape)) +
  geom_point() +
  geom_jitter() +
  facet_wrap(~site)+
  labs(x = "Burrow Shape", y = "Burrow Temperature (°C)") +
  labs(title = "Burrow Shape vs Temperature") +
  theme(plot.title = element_text(hjust = 0.5))
print(burrow_data_plot_2)
```


## Conclusion
Further analysis is needed to conclude any findings.











